<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>Kingshot Survival - Web Edition</title>
  <style>
    body {
      font-family: 'Segoe UI', serif;
      background: linear-gradient(#1a1a1a, #2a2a2a);
      color: #d4af37;
      margin: 0;
      padding: 20px;
      animation: flicker 3s infinite;
    }

    @keyframes flicker {
      0%, 100% { background-color: #1a1a1a; }
      50% { background-color: #222; }
    }

    #game-ui {
      display: grid;
      grid-template-columns: 1fr 300px;
      gap: 20px;
      max-width: 1000px;
      margin: auto;
    }

    .stat-box {
      background: #2d2d2d;
      border: 2px solid #d4af37;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .log-box {
      height: 300px;
      background: #000;
      color: #0f0;
      padding: 10px;
      overflow-y: auto;
      font-size: 0.9rem;
      border: 1px solid #444;
    }

    button {
      background: #d4af37;
      color: #1a1a1a;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      font-weight: bold;
      margin: 5px;
    }

    button:disabled {
      background: #555;
      cursor: not-allowed;
    }

    .event-alert {
      color: #ff4444;
      font-weight: bold;
      animation: shake 0.4s ease;
    }

    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-3px); }
      50% { transform: translateX(3px); }
      75% { transform: translateX(-3px); }
      100% { transform: translateX(0); }
    }

    @keyframes pop {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); color: #fff; }
      100% { transform: scale(1); }
    }

    .stat-change {
      animation: pop 0.3s ease;
    }
  </style>
</head>
<body>

  <h1 style="text-align: center;">ğŸ›¡ï¸ KINGSHOT: ç‹æœé¤˜ç«</h1>

  <div id="game-ui">
    <div class="main-panel">
      <div class="stat-box">
        <h2>é ˜åœ°ç‹€æ…‹ - ç¬¬ <span id="day">1</span> å¤©</h2>
        <p>äººå£: <span id="pop">50</span> | ç³§é£Ÿ: <span id="food">100</span> | æœ¨æ: <span id="wood">50</span></p>
        <p>æ–‡æ˜ç«ç¨®: <span id="civ">100%</span> (ä½æ–¼ 0% éŠæˆ²çµæŸ)</p>
      </div>

      <div class="stat-box">
        <h3>å»ºè¨­èˆ‡æŒ‡ä»¤</h3>
        <button onclick="build('farm')">å»ºé€ è¾²ç”° (20æœ¨æ)</button>
        <button onclick="build('house')">å»ºé€ æ°‘å®… (30æœ¨æ)</button>
        <button onclick="gatherWood()">æ´¾é£æ¡é›† (æœ¨æ+10)</button>
      </div>
    </div>

    <div class="side-panel">
      <h3>ç‹åœ‹æ—¥èªŒ</h3>
      <div id="log" class="log-box"></div>
    </div>
  </div>

  <script>
    let gameState = {
      day: 1,
      pop: 50,
      food: 100,
      wood: 50,
      civ: 100,
      farms: 1,
      houses: 1
    };

    function addLog(msg, isAlert = false) {
      const log = document.getElementById('log');
      const time = new Date().toLocaleTimeString();
      log.innerHTML = `<p class="${isAlert ? 'event-alert' : ''}">[${time}] ${msg}</p>` + log.innerHTML;
    }

    function animateStat(id) {
      const el = document.getElementById(id);
      el.classList.add('stat-change');
      setTimeout(() => el.classList.remove('stat-change'), 300);
    }

    function gatherWood() {
      gameState.wood += 10;
      addLog("æ´¾é£å­æ°‘é€²å…¥æ£®æ—ï¼Œæ¡é›†äº† 10 å–®ä½æœ¨æã€‚");
      updateUI();
    }

    function build(type) {
      if (type === 'farm' && gameState.wood >= 20) {
        gameState.wood -= 20;
        gameState.farms++;
        addLog("è¾²ç”°å»ºæˆï¼Œç³§é£Ÿç”¢é‡æå‡ã€‚");
      } else if (type === 'house' && gameState.wood >= 30) {
        gameState.wood -= 30;
        gameState.houses++;
        gameState.pop += 10;
        addLog("æ–°å»ºäº†æ°‘å®…ï¼Œæµé›¢å¤±æ‰€çš„é›£æ°‘åŠ å…¥äº†æˆ‘å€‘ã€‚");
      } else {
        addLog("è³‡æºä¸è¶³ï¼Œç„¡æ³•å»ºè¨­ï¼", true);
      }
      updateUI();
    }

    function updateUI() {
      document.getElementById('day').innerText = gameState.day;
      document.getElementById('pop').innerText = gameState.pop;
      document.getElementById('food').innerText = gameState.food;
      document.getElementById('wood').innerText = gameState.wood;
      document.getElementById('civ').innerText = gameState.civ + "%";

      animateStat('pop');
      animateStat('food');
      animateStat('wood');
      animateStat('civ');

      if (gameState.civ <= 0) {
        alert("æ–‡æ˜ç«ç¨®ç†„æ»…ï¼Œç‹æœè¦†æ»…...");
        location.reload();
      }
    }

    // éŠæˆ²æ ¸å¿ƒå¾ªç’° (æ¯ 5 ç§’ä»£è¡¨ä¸€å¤©)
    setInterval(() => {
      gameState.day++;

      let production = gameState.farms * 15;
      let consumption = gameState.pop * 0.5;
      gameState.food += (production - Math.floor(consumption));

      if (gameState.food < 0) {
        gameState.food = 0;
        gameState.pop -= 5;
        gameState.civ -= 10;
        addLog("é£¢è’è”“å»¶ï¼å­æ°‘æ­£åœ¨æ­»å»ï¼Œæ–‡æ˜æ­£åœ¨è¡°é€€ã€‚", true);
      }

      if (Math.random() > 0.8) {
        const events = [
          { name: "æš´æ°‘å…¥ä¾µ", effect: () => { gameState.wood -= 10; addLog("æš´æ°‘æ´—åŠ«äº†å€‰åº«ï¼Œæœ¨ææå¤± 10ã€‚", true); } },
          { name: "æ™‚ç–«çˆ†ç™¼", effect: () => { gameState.pop -= 8; addLog("æ™‚ç–«å¥ªèµ°äº†æ•¸æ¢ç”Ÿå‘½ã€‚", true); } },
          { name: "å•†éšŠæŠµé”", effect: () => { gameState.food += 20; addLog("é æ–¹çš„å•†éšŠç•™ä¸‹äº†ç³§é£Ÿã€‚"); } }
        ];
        const evt = events[Math.floor(Math.random() * events.length)];
        evt.effect();
      }

      updateUI();
    }, 5000);

    addLog("å›äº‚ç™¼ç”Ÿäº†ï¼Œä½ å¸¶é ˜å€–å­˜è€…å»ºç«‹ç‡Ÿåœ°ã€‚");
  </script>
</body>
</html>
